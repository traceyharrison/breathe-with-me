<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Breathe with Me - A calming breathing exercise app with visual guidance and customizable patterns">
    <title>Breathe with Me - Calm Your Mind</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <button class="settings-icon" onclick="toggleSettingsMenu()" aria-label="Settings">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <span class="settings-label">Settings</span>
        </button>

        <button class="timer-icon" onclick="toggleTimerMenu()" aria-label="Session Timer">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12,6 12,12 16,14"></polyline>
            </svg>
            <span class="timer-label">Timer</span>
        </button>

        <div class="settings-menu" id="settingsMenu">
            <div class="settings-menu-header">
                <h3>Audio Settings</h3>
                <button class="close-btn" onclick="toggleSettingsMenu()">×</button>
            </div>
            <div class="settings-menu-content">
                <div class="toggle-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="pingToggle" checked onchange="togglePing()">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Transition Ping</span>
                    </label>
                    <div class="audio-status" id="audioStatus" style="margin-top: 8px; font-size: 0.8em; opacity: 0.7;">
                        Audio: <span id="audioStatusText">Tap to enable</span>
                    </div>
                </div>
                <div class="theme-selection" style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.08);">
                    <label class="selection-label">Theme:</label>
                    <div class="theme-options">
                        <button class="theme-btn active" onclick="setTheme('night-sky')" data-theme="night-sky">
                            <span class="theme-preview night-sky-preview"></span>
                            Night Sky
                        </button>
                        <button class="theme-btn" onclick="setTheme('lofi')" data-theme="lofi">
                            <span class="theme-preview lofi-preview"></span>
                            LoFi
                        </button>
                        <button class="theme-btn" onclick="setTheme('sunset')" data-theme="sunset">
                            <span class="theme-preview sunset-preview"></span>
                            Forest
                        </button>
                    </div>
                </div>
                <div class="music-selection" id="pingSelection" style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.08);">
                    <label class="selection-label">Dynamic Ping System:</label>
                    <div class="ping-info">
                        <div class="ping-phase">• Breathe In: <span class="ping-tone">Low tone</span> (A2 - 110Hz)</div>
                        <div class="ping-phase">• Hold: <span class="ping-tone">Medium tone</span> (A3 - 220Hz)</div>
                        <div class="ping-phase">• Breathe Out: <span class="ping-tone">High tone</span> (A4 - 440Hz)</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="timer-menu" id="timerMenu">
            <div class="timer-menu-header">
                <h3>Session Timer</h3>
                <button class="close-btn" onclick="toggleTimerMenu()">×</button>
            </div>
            <div class="timer-menu-content">
                <div class="timer-status" id="timerStatus">No timer set</div>
                <div class="timer-display" id="timerDisplay" style="display: none;">00:00</div>
                
                <div class="timer-presets">
                    <h4>Quick Start</h4>
                    <div class="preset-timer-buttons">
                        <button class="timer-preset-btn" onclick="setTimerPreset(2)">2 min</button>
                        <button class="timer-preset-btn" onclick="setTimerPreset(5)">5 min</button>
                        <button class="timer-preset-btn" onclick="setTimerPreset(10)">10 min</button>
                    </div>
                </div>
                
                <div class="custom-timer">
                    <h4>Custom Duration</h4>
                    <div class="timer-input-group">
                        <label>Minutes: <span id="timerMinValue">5</span></label>
                        <input type="range" id="timerMinSlider" min="1" max="60" value="5" oninput="updateTimerDisplay()">
                    </div>
                    <button class="timer-set-btn" onclick="setCustomTimer()">Set Custom Timer</button>
                </div>
                
                <div class="timer-controls" id="timerControls" style="display: none;">
                    <button class="timer-start-btn" id="timerStartBtn" onclick="startTimer()">Start Timer</button>
                    <button class="timer-stop-btn" id="timerStopBtn" onclick="stopTimer()" style="display: none;">Stop Timer</button>
                </div>
            </div>
        </div>

        <h1>Breathe with Me</h1>
        <p class="subtitle">Breathing Exercises to Soothe Anxiety</p>
        
        <div class="settings" id="settings">
            <h3>Breathing Pattern</h3>
            <div class="preset-buttons">
                <button class="preset-btn active" onclick="setPreset('box')">Box (4-4-4-4)</button>
                <button class="preset-btn" onclick="setPreset('relaxing')">Relaxing (4-7-8)</button>
                <button class="preset-btn" onclick="setPreset('energizing')">Energizing (4-4-6)</button>
            </div>
            <div class="custom-button-row">
                <button class="preset-btn" onclick="setPreset('custom')">Custom</button>
            </div>
            
            <div class="custom-controls" id="customControls" style="display: none;">
                <div class="custom-controls-header">
                    <h4>Custom Pattern</h4>
                    <button class="close-btn" onclick="closeCustomControls()" title="Close dialog (pattern will remain active)">×</button>
                </div>
                <div class="slider-group">
                    <label>Breathe In: <span id="breatheInValue">4</span>s</label>
                    <input type="range" id="breatheInSlider" min="2" max="10" value="4" oninput="updateCustom()">
                </div>
                <div class="slider-group">
                    <label>Hold (After In): <span id="holdInValue">4</span>s</label>
                    <input type="range" id="holdInSlider" min="0" max="10" value="4" oninput="updateCustom()">
                </div>
                <div class="slider-group">
                    <label>Breathe Out: <span id="breatheOutValue">4</span>s</label>
                    <input type="range" id="breatheOutSlider" min="2" max="10" value="4" oninput="updateCustom()">
                </div>
                <div class="slider-group">
                    <label>Hold (After Out): <span id="holdOutValue">4</span>s</label>
                    <input type="range" id="holdOutSlider" min="0" max="10" value="4" oninput="updateCustom()">
                </div>
                <div class="custom-actions">
                    <div class="pattern-name-group">
                        <label for="patternName">Pattern Name:</label>
                        <input type="text" id="patternName" placeholder="My Custom Pattern" maxlength="30">
                    </div>
                    <button class="save-btn" onclick="saveCustomPattern()">Save Pattern</button>
                    <div class="saved-patterns" id="savedPatterns">
                        <h5>Saved Patterns:</h5>
                        <div class="saved-patterns-list" id="savedPatternsList">
                            <!-- Saved patterns will appear here -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="start-btn" id="startBtn" onclick="startBreathing()">Start</button>
                <button class="stop-btn" id="stopBtn" onclick="stopBreathing()" disabled>Stop</button>
            </div>
        </div>
        
        <div class="instruction" id="instruction">Press Start to Begin</div>
        <div class="counter" id="counter">4</div>
        
        <div class="breathing-box">
            <div class="box" id="breathingBox"></div>
        </div>
        
        <div class="session-timer-display" id="sessionTimerDisplay" style="display: none;">
            <div class="session-timer-text">Session Time Remaining</div>
            <div class="session-timer-countdown" id="sessionTimerCountdown">00:00</div>
        </div>
        
        <div class="info">
            <p>Choose from preset patterns or create your own custom breathing rhythm. Toggle the transition ping sound to customize your experience. Follow the visual cue and listen for the gentle ping to guide your breathing.</p>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
